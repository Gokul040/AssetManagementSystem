import { FileExporter } from './file-exporter';
import { Injectable } from '@angular/core';
import * as i0 from "@angular/core";
import * as i1 from "../sheetjs-helper.service";
/**
 * An angular service class that is used to create files out of json object arrays.
 */
export class WorksheetExporter extends FileExporter {
    constructor(sheetJsHelper) {
        super();
        this.sheetJsHelper = sheetJsHelper;
    }
    async createContent(rows, options) {
        const workSheet = (await this.sheetJsHelper.getXlsx()).utils.json_to_sheet(rows, {
            skipHeader: true // we don't want to see object properties as our headers
        });
        return await this.workSheetToContent(workSheet, options);
    }
}
WorksheetExporter.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.3", ngImport: i0, type: WorksheetExporter, deps: [{ token: i1.SheetjsHelperService }], target: i0.ɵɵFactoryTarget.Injectable });
WorksheetExporter.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "15.2.3", ngImport: i0, type: WorksheetExporter, providedIn: 'root' });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.3", ngImport: i0, type: WorksheetExporter, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root'
                }]
        }], ctorParameters: function () { return [{ type: i1.SheetjsHelperService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid29ya3NoZWV0LWV4cG9ydGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvY2RrLXRhYmxlLWV4cG9ydGVyL3NyYy9saWIvc2VydmljZXMvZXhwb3J0ZXJzL3dvcmtzaGVldC1leHBvcnRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFHL0MsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQzs7O0FBQzNDOztHQUVHO0FBSUgsTUFBTSxPQUFnQixpQkFBcUMsU0FBUSxZQUFlO0lBRWhGLFlBQXNCLGFBQW1DO1FBQ3ZELEtBQUssRUFBRSxDQUFDO1FBRFksa0JBQWEsR0FBYixhQUFhLENBQXNCO0lBRXpELENBQUM7SUFFTSxLQUFLLENBQUMsYUFBYSxDQUFDLElBQWdCLEVBQUUsT0FBVztRQUN0RCxNQUFNLFNBQVMsR0FBZSxDQUFDLE1BQU0sSUFBSSxDQUFDLGFBQWEsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsSUFBSSxFQUFFO1lBQzNGLFVBQVUsRUFBRSxJQUFJLENBQUMsd0RBQXdEO1NBQzFFLENBQUMsQ0FBQztRQUNILE9BQU8sTUFBTSxJQUFJLENBQUMsa0JBQWtCLENBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQzNELENBQUM7OzhHQVhtQixpQkFBaUI7a0hBQWpCLGlCQUFpQixjQUZ6QixNQUFNOzJGQUVFLGlCQUFpQjtrQkFIdEMsVUFBVTttQkFBQztvQkFDVixVQUFVLEVBQUUsTUFBTTtpQkFDbkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBXb3JrU2hlZXQgfSBmcm9tICd4bHN4JztcbmltcG9ydCB7IE1pbWUgfSBmcm9tICcuLi8uLi9taW1lJztcbmltcG9ydCB7IEZpbGVFeHBvcnRlciB9IGZyb20gJy4vZmlsZS1leHBvcnRlcic7XG5pbXBvcnQgeyBTaGVldGpzSGVscGVyU2VydmljZSB9IGZyb20gJy4uL3NoZWV0anMtaGVscGVyLnNlcnZpY2UnO1xuaW1wb3J0IHsgT3B0aW9ucyB9IGZyb20gJy4uLy4uL29wdGlvbnMnO1xuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuLyoqXG4gKiBBbiBhbmd1bGFyIHNlcnZpY2UgY2xhc3MgdGhhdCBpcyB1c2VkIHRvIGNyZWF0ZSBmaWxlcyBvdXQgb2YganNvbiBvYmplY3QgYXJyYXlzLlxuICovXG5ASW5qZWN0YWJsZSh7XG4gIHByb3ZpZGVkSW46ICdyb290J1xufSlcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBXb3Jrc2hlZXRFeHBvcnRlcjxUIGV4dGVuZHMgT3B0aW9ucz4gZXh0ZW5kcyBGaWxlRXhwb3J0ZXI8VD4ge1xuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBzaGVldEpzSGVscGVyOiBTaGVldGpzSGVscGVyU2VydmljZSkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgY3JlYXRlQ29udGVudChyb3dzOiBBcnJheTxhbnk+LCBvcHRpb25zPzogVCk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3Qgd29ya1NoZWV0OiBXb3JrU2hlZXQgPSAgKGF3YWl0IHRoaXMuc2hlZXRKc0hlbHBlci5nZXRYbHN4KCkpLnV0aWxzLmpzb25fdG9fc2hlZXQocm93cywge1xuICAgICAgc2tpcEhlYWRlcjogdHJ1ZSAvLyB3ZSBkb24ndCB3YW50IHRvIHNlZSBvYmplY3QgcHJvcGVydGllcyBhcyBvdXIgaGVhZGVyc1xuICAgIH0pO1xuICAgIHJldHVybiBhd2FpdCB0aGlzLndvcmtTaGVldFRvQ29udGVudCh3b3JrU2hlZXQsIG9wdGlvbnMpO1xuICB9XG4gIHB1YmxpYyBhYnN0cmFjdCB3b3JrU2hlZXRUb0NvbnRlbnQod29ya1NoZWV0OiBXb3JrU2hlZXQsIG9wdGlvbnM/OiBUKTogUHJvbWlzZTxhbnk+O1xuICBwdWJsaWMgYWJzdHJhY3Qgb3ZlcnJpZGUgZ2V0TWltZVR5cGUoKTogTWltZTtcblxufVxuIl19